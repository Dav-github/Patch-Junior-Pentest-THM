## Introduction (What is Command Injection?)

Command Injection acontece quando um atacante consegue abusar do comportamento de um app quando ele executa comandos do sistema operacional, lembrando que os comando são executados com o mesmo privilégio da função.

https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report

https://owasp.org/www-project-top-ten/

## Discovering Command Injection

Devemos procurar funções que façam chamadas para o sistema operacional, cada linguagem tem funções específicas então deve ser feito uma analise primeiro.

## Exploiting Command Injection

encontrado a função que faz a chama para o sistema operacional, podemos utilizar de operadores e comandos do sistema em questão para explorar o alvo, semelhante ao XSS com essa vuln temos o tipo verbose que é quando o resultado é retornado para o atacante, e o blind que é oposto.

![alt text](image.png)

Uma boa forma de verificar o sucesso de um blind command injection é com um payload que faça uma conexão com um servidor seu, com comandos com curl ou ping.

## Remediating Command Injection

Podemos fazer a defesa dessa vuln em varias camadas, devemos filtrar todas as funções e inputs que um usuário tem acesso.

![alt text](image-1.png)

---

![alt text](image-2.png)

Tb podemos sanitisar os inputs, isso significa remover caracteres especiais como >, &. ;, / etc.

![alt text](image-3.png)

Em um sistema real, geramente vamos encontrar algum nível de segurança, então devemos procurar tecnicas para "bypassar" os filtros, uma das formas é encodar o payload para hexadecimal
